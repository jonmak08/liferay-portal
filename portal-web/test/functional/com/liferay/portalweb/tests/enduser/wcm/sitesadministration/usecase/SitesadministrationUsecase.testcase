<definition component-name="portal-wcm">
	<property name="portal.release" value="true" />
	<property name="portal.upstream" value="true" />
	<property name="testray.main.component.name" value="Sites Administration" />

	<set-up>
		<execute macro="User#firstLoginPG" />
	</set-up>

	<tear-down>
		<execute macro="User#tearDownCP" />

		<execute macro="Site#tearDownCP" />

		<execute macro="Organization#tearDownCP" />

		<execute macro="Team#tearDownCP" />

		<execute macro="Page#tearDownPG" />
	</tear-down>

	<command name="AddOrganizationSitesAndDeactivate" priority="5">
		<execute macro="Page#gotoCP">
			<var name="portletName" value="Users and Organizations" />
		</execute>

		<execute macro="Organization#addCP">
			<var name="orgName" value="Organization Name 1" />
			<var name="orgType" value="Regular Organization" />
		</execute>

		<execute macro="Page#gotoCP">
			<var name="portletName" value="Users and Organizations" />
		</execute>

		<execute macro="Organization#addSiteCP">
			<var name="organizationSite" value="Community Site" />
			<var name="orgName" value="Organization Name 1" />
		</execute>

		<execute macro="Page#gotoCP">
			<var name="portletName" value="Users and Organizations" />
		</execute>

		<execute macro="Organization#manageMembershipOptionsInSites">
			<var name="allowManualMembershipManagement" value="true" />
			<var name="membershipType" value="Open" />
			<var name="orgName" value="Organization Name 1" />
			<var name="selectMembershipType" value="true" />
		</execute>

		<execute macro="Page#gotoCP">
			<var name="portletName" value="Sites" />
		</execute>

		<execute macro="Site#viewCP">
			<var name="siteMember" value="Organization" />
			<var name="siteName" value="Organization Name 1" />
		</execute>

		<execute macro="Page#gotoCP">
			<var name="portletName" value="Users and Organizations" />
		</execute>

		<execute macro="Organization#addCP">
			<var name="orgName" value="Organization Name 2" />
			<var name="orgType" value="Regular Organization" />
		</execute>

		<execute macro="Page#gotoCP">
			<var name="portletName" value="Users and Organizations" />
		</execute>

		<execute macro="Organization#addSiteCP">
			<var name="organizationSite" value="Intranet Site" />
			<var name="orgName" value="Organization Name 2" />
		</execute>

		<execute macro="Page#gotoCP">
			<var name="portletName" value="Users and Organizations" />
		</execute>

		<execute macro="Organization#manageMembershipOptionsInSites">
			<var name="allowManualMembershipManagement" value="true" />
			<var name="membershipType" value="Open" />
			<var name="orgName" value="Organization Name 2" />
			<var name="selectMembershipType" value="true" />
		</execute>

		<execute macro="Page#gotoCP">
			<var name="portletName" value="Sites" />
		</execute>

		<execute macro="Site#viewCP">
			<var name="siteMember" value="Organization" />
			<var name="siteName" value="Organization Name 2" />
		</execute>

		<execute macro="Page#gotoCP">
			<var name="portletName" value="Users and Organizations" />
		</execute>

		<execute macro="User#addCP">
			<var name="userEmailAddress" value="userea@liferay.com" />
			<var name="userFirstName" value="userfn" />
			<var name="userLastName" value="userln" />
			<var name="userScreenName" value="usersn" />
		</execute>

		<execute macro="Page#gotoCP">
			<var name="portletName" value="Users and Organizations" />
		</execute>

		<execute macro="User#editPasswordCP">
			<var name="userEmailAddress" value="userea@liferay.com" />
			<var name="userScreenName" value="usersn" />
		</execute>

		<execute macro="Page#gotoCP">
			<var name="portletName" value="Users and Organizations" />
		</execute>

		<execute macro="Site#assignUserSitesCP">
			<var name="siteName" value="Organization Name 1" />
			<var name="userScreenName" value="usersn" />
		</execute>

		<execute macro="Page#gotoCP">
			<var name="portletName" value="Users and Organizations" />
		</execute>

		<execute macro="Site#assignUserSitesCP">
			<var name="siteName" value="Organization Name 2" />
			<var name="userScreenName" value="usersn" />
		</execute>

		<execute macro="Page#gotoCP">
			<var name="portletName" value="Roles" />
		</execute>

		<execute macro="Role#assignRegRoleCP">
			<var name="roleName" value="Administrator" />
			<var name="userScreenName" value="usersn" />
		</execute>

		<execute macro="User#firstLoginPG">
			<var name="userEmailAddress" value="userea@liferay.com" />
		</execute>

		<execute macro="SitePage#viewDefaultSiteTemplatePagesPG">
			<var name="siteName" value="Organization Name 1" />
			<var name="siteTemplate" value="Community" />
		</execute>

		<execute macro="SitePage#viewDefaultSiteTemplatePagesPG">
			<var name="siteName" value="Organization Name 2" />
			<var name="siteTemplate" value="Intranet" />
		</execute>

		<execute macro="Page#gotoCP">
			<var name="portletName" value="Sites" />
			<var name="siteName" value="Organization Name 2" />
			<var name="siteURL" value="true" />
		</execute>

		<execute macro="Site#deactivateCP">
			<var name="siteName" value="Organization Name 2" />
		</execute>

		<execute macro="User#firstLoginPG">
			<var name="password" value="test" />
			<var name="userEmailAddress" value="test@liferay.com" />
		</execute>

		<execute macro="Page#gotoCP">
			<var name="portletName" value="Sites" />
		</execute>

		<execute macro="Site#deactivateCP">
			<var name="siteName" value="Organization Name 2" />
			<var name="successMessage" value="true" />
		</execute>

		<execute macro="User#firstLoginPG">
			<var name="password" value="test" />
			<var name="userEmailAddress" value="userea@liferay.com" />
		</execute>

		<execute macro="Site#viewMySitesViaMySitesPG">
			<var name="organizationSite" value="true" />
			<var name="siteName" value="Organization Name 2" />
		</execute>

		<execute macro="Page#openURL">
			<var name="siteName" value="Organization Name 2" />
			<var name="siteURL" value="true" />
		</execute>

		<execute function="AssertTextEquals" locator1="Home#ERROR_MESSAGE_ALERT_INFO" value1="This site is inactive. Please contact the administrator." />

		<execute macro="User#firstLoginPG">
			<var name="password" value="test" />
			<var name="userEmailAddress" value="test@liferay.com" />
		</execute>
	</command>

	<command name="ApplicationAdapter" priority="5">
		<property name="hook.plugins.includes" value="sample-application-adapter-hook" />

		<execute macro="Page#gotoCP">
			<var name="portletName" value="Sites" />
		</execute>

		<execute macro="Site#addBlankCP">
			<var name="siteName" value="Site A" />
		</execute>

		<execute macro="Page#gotoConfigurationCP">
			<var name="portletName" value="Site Settings" />
			<var name="siteScopeName" value="Site A" />
		</execute>

		<execute function="Select" locator1="CPSitesettings#APPLICATION_ADAPTER_SELECT" value1="Sample Application Adapter EE Hook" />
		<execute function="AssertClick#assertTextClickAtAndWait" locator1="CPSitesettings#SAVE_BUTTON" value1="Save" />

		<execute macro="Page#gotoCP">
			<var name="portletName" value="Sites" />
		</execute>

		<execute macro="SitePage#addCP">
			<var name="siteName" value="Site A" />
			<var name="sitePageName" value="Test Page A" />
			<var name="sitePagePrivacy" value="Public" />
		</execute>

		<execute macro="Page#gotoPG">
			<var name="pageName" value="Test Page A" />
			<var name="siteName" value="Site A" />
			<var name="siteURL" value="true" />
		</execute>

		<execute macro="Portlet#addPG">
			<var name="portletName" value="Navigation" />
		</execute>

		<var name="key_portletName" value="Navigation" />

		<execute function="AssertTextEquals#assertPartialText" locator1="PGNavigation#PORTLET_BODY" value1="This was modified by the Sample Application Adapter." />

		<execute macro="Page#gotoCP">
			<var name="portletName" value="Sites" />
		</execute>

		<execute macro="Site#addBlankCP">
			<var name="siteName" value="Site B" />
		</execute>

		<execute macro="Page#gotoCP">
			<var name="portletName" value="Sites" />
		</execute>

		<execute macro="SitePage#addCP">
			<var name="siteName" value="Site B" />
			<var name="sitePageName" value="Test Page B" />
			<var name="sitePagePrivacy" value="Public" />
		</execute>

		<execute macro="Page#gotoPG">
			<var name="pageName" value="Test Page B" />
			<var name="siteName" value="Site B" />
			<var name="siteURL" value="true" />
		</execute>

		<execute macro="Portlet#addPG">
			<var name="portletName" value="Navigation" />
		</execute>

		<var name="key_portletName" value="Navigation" />

		<execute function="AssertTextNotPresent" locator1="PGNavigation#PORTLET_BODY" value1="This was modified by the Sample Application Adapter." />

		<execute macro="Page#gotoConfigurationCP">
			<var name="portletName" value="Site Settings" />
			<var name="siteScopeName" value="Site B" />
		</execute>

		<execute function="Select" locator1="CPSitesettings#APPLICATION_ADAPTER_SELECT" value1="Sample Application Adapter EE Hook" />
		<execute function="AssertClick#assertTextClickAtAndWait" locator1="CPSitesettings#SAVE_BUTTON" value1="Save" />

		<execute macro="Page#gotoPG">
			<var name="pageName" value="Test Page B" />
			<var name="siteName" value="Site B" />
			<var name="siteURL" value="true" />
		</execute>

		<var name="key_portletName" value="Navigation" />

		<execute function="AssertTextEquals#assertPartialText" locator1="PGNavigation#PORTLET_BODY" value1="This was modified by the Sample Application Adapter." />

		<execute macro="Page#gotoConfigurationCP">
			<var name="portletName" value="Site Settings" />
			<var name="siteScopeName" value="Site B" />
		</execute>

		<execute function="Select" locator1="CPSitesettings#APPLICATION_ADAPTER_SELECT" value1="None" />
		<execute function="AssertClick#assertTextClickAtAndWait" locator1="CPSitesettings#SAVE_BUTTON" value1="Save" />

		<execute macro="Page#gotoPG">
			<var name="pageName" value="Test Page B" />
			<var name="siteName" value="Site B" />
			<var name="siteURL" value="true" />
		</execute>

		<var name="key_portletName" value="Navigation" />

		<execute function="AssertTextNotPresent" locator1="PGNavigation#PORTLET_BODY" value1="This was modified by the Sample Application Adapter." />
	</command>

	<command name="SiteTeams" priority="4">
		<execute macro="Page#gotoCP">
			<var name="portletName" value="Sites" />
		</execute>

		<execute macro="Site#addBlankCP">
			<var name="siteName" value="Site Name" />
		</execute>

		<execute macro="Page#gotoCP">
			<var name="portletName" value="Users and Organizations" />
		</execute>

		<execute macro="User#addCP">
			<var name="userEmailAddress" value="userea1@liferay.com" />
			<var name="userFirstName" value="userfn1" />
			<var name="userLastName" value="userln1" />
			<var name="userScreenName" value="usersn1" />
		</execute>

		<execute macro="User#addCP">
			<var name="userEmailAddress" value="userea2@liferay.com" />
			<var name="userFirstName" value="userfn2" />
			<var name="userLastName" value="userln2" />
			<var name="userScreenName" value="usersn2" />
		</execute>

		<execute macro="Page#gotoCP">
			<var name="portletName" value="User Groups" />
		</execute>

		<execute macro="UserGroup#addCP">
			<var name="userGroupName" value="UG UserGroup1 Name" />
		</execute>

		<execute macro="UserGroup#addCP">
			<var name="userGroupName" value="UG UserGroup2 Name" />
		</execute>

		<execute macro="Page#gotoUsersCP">
			<var name="portletName" value="Site Memberships" />
			<var name="siteScopeName" value="Site Name" />
		</execute>

		<execute macro="Site#addMemberCP">
			<var name="siteName" value="Site Name" />
			<var name="siteScopeName" value="Site Name" />
			<var name="userFirstName" value="userfn1" />
			<var name="userLastName" value="userln1" />
			<var name="userScreenName" value="usersn1" />
		</execute>

		<execute macro="Site#addMemberUserGroupCP">
			<var name="siteName" value="Site Name" />
			<var name="siteScopeName" value="Site Name" />
			<var name="userGroupName" value="UG UserGroup1 Name" />
		</execute>

		<execute macro="Page#gotoCP">
			<var name="portletName" value="User Groups" />
		</execute>

		<execute macro="UserGroup#assignMemberCP">
			<var name="userGroupName" value="UG UserGroup1 Name" />
			<var name="userScreenName" value="usersn1" />
		</execute>

		<execute macro="Page#gotoCP">
			<var name="portletName" value="User Groups" />
		</execute>

		<execute macro="UserGroup#assignMemberCP">
			<var name="userGroupName" value="UG UserGroup2 Name" />
			<var name="userScreenName" value="usersn2" />
		</execute>

		<execute macro="Page#gotoUsersCP">
			<var name="portletName" value="Site Teams" />
			<var name="siteScopeName" value="Site Name" />
		</execute>

		<execute macro="Team#addCP">
			<var name="teamDescription" value="Site Team Description" />
			<var name="teamName" value="Site Team Name" />
		</execute>

		<execute macro="Page#gotoUsersCP">
			<var name="portletName" value="Site Teams" />
			<var name="siteScopeName" value="Site Name" />
		</execute>

		<execute macro="Team#assignMembersCP">
			<var name="teamName" value="Site Team Name" />
			<var name="userScreenName" value="usersn1" />
		</execute>

		<execute macro="Page#gotoUsersCP">
			<var name="portletName" value="Site Teams" />
			<var name="siteScopeName" value="Site Name" />
		</execute>

		<execute macro="Team#assignMembersCP">
			<var name="teamName" value="Site Team Name" />
			<var name="userNameIsNotFound" value="true" />
			<var name="userScreenName" value="usersn2" />
		</execute>

		<execute macro="Page#gotoUsersCP">
			<var name="portletName" value="Site Teams" />
			<var name="siteScopeName" value="Site Name" />
		</execute>

		<execute macro="Team#assignUserGroups">
			<var name="teamName" value="Site Team Name" />
			<var name="userGroupName" value="UG UserGroup1 Name" />
		</execute>

		<execute macro="Page#gotoUsersCP">
			<var name="portletName" value="Site Teams" />
			<var name="siteScopeName" value="Site Name" />
		</execute>

		<execute macro="Team#assignUserGroups">
			<var name="teamName" value="Site Team Name" />
			<var name="userGroupName" value="UG UserGroup2 Name" />
			<var name="userGroupsNameIsNotAvailable" value="true" />
		</execute>
	</command>

	<command name="SiteTeamsPermissions" priority="4">
		<execute macro="Page#gotoCP">
			<var name="portletName" value="Users and Organizations" />
		</execute>

		<execute macro="User#addCP">
			<var name="userEmailAddress" value="userea1@liferay.com" />
			<var name="userFirstName" value="userfn1" />
			<var name="userLastName" value="userln1" />
			<var name="userScreenName" value="usersn1" />
		</execute>

		<execute macro="Page#gotoCP">
			<var name="portletName" value="Users and Organizations" />
		</execute>

		<execute macro="User#editPasswordCP">
			<var name="userEmailAddress" value="userea1@liferay.com" />
			<var name="userScreenName" value="usersn1" />
		</execute>

		<execute macro="Page#gotoCP">
			<var name="portletName" value="Users and Organizations" />
		</execute>

		<execute macro="User#editUserSiteCP">
			<var name="siteName" value="Liferay" />
			<var name="userScreenName" value="usersn1" />
		</execute>

		<execute macro="Page#gotoCP">
			<var name="portletName" value="Users and Organizations" />
		</execute>

		<execute macro="User#addCP">
			<var name="userEmailAddress" value="userea2@liferay.com" />
			<var name="userFirstName" value="userfn2" />
			<var name="userLastName" value="userln2" />
			<var name="userScreenName" value="usersn2" />
		</execute>

		<execute macro="Page#gotoCP">
			<var name="portletName" value="Users and Organizations" />
		</execute>

		<execute macro="User#editPasswordCP">
			<var name="userEmailAddress" value="userea2@liferay.com" />
			<var name="userScreenName" value="usersn2" />
		</execute>

		<execute macro="Page#gotoCP">
			<var name="portletName" value="Users and Organizations" />
		</execute>

		<execute macro="User#editUserSiteCP">
			<var name="siteName" value="Liferay" />
			<var name="userScreenName" value="usersn2" />
		</execute>

		<execute macro="Page#gotoUsersCP">
			<var name="portletName" value="Site Teams" />
		</execute>

		<execute macro="Team#addCP">
			<var name="teamDescription" value="Site Team Description" />
			<var name="teamName" value="Site Team Name" />
		</execute>

		<execute macro="Page#gotoUsersCP">
			<var name="portletName" value="Site Teams" />
		</execute>

		<execute macro="Team#assignMembersCP">
			<var name="teamName" value="Site Team Name" />
			<var name="userScreenName" value="usersn1" />
		</execute>

		<execute macro="Page#gotoCP">
			<var name="portletName" value="Sites" />
		</execute>

		<execute macro="Site#addBlankCP">
			<var name="siteName" value="Site Name" />
		</execute>

		<execute macro="Page#gotoUsersCP">
			<var name="portletName" value="Site Teams" />
			<var name="siteScopeName" value="Site Name" />
		</execute>

		<execute macro="Team#viewDefaultCP">
			<var name="teamName" value="Site Team Name" />
		</execute>

		<execute macro="Page#addPG">
			<var name="pageName" value="Blog Page Template" />
			<var name="pageTemplateName" value="Blog" />
		</execute>

		<execute macro="PermissionsInline#gotoPagePG">
			<var name="pageName" value="Blog Page Template" />
			<var name="siteName" value="Site Name" />
		</execute>

		<execute macro="Role#removePermissionPG">
			<var name="permissionDefinitionKey" value="CONTENT_PERMISSIONS_VIEW_CHECKBOX" />
			<var name="roleName" value="Guest" />
		</execute>

		<execute macro="PermissionsInline#gotoPagePG">
			<var name="pageName" value="Blog Page Template" />
			<var name="siteName" value="Site Name" />
		</execute>

		<for list="CONTENT_PERMISSIONS_ADD_DISCUSSION_CHECKBOX,CONTENT_PERMISSIONS_VIEW_CHECKBOX" param="permissionsInLineUncheckListsCount" >
			<execute macro="Role#removePermissionPG">
				<var name="permissionDefinitionKey" value="${permissionsInLineUncheckListsCount}" />
				<var name="roleName" value="Site Member" />
			</execute>
		</for>

		<execute macro="PermissionsInline#gotoPagePG">
			<var name="pageName" value="Blog Page Template" />
			<var name="siteName" value="Site Name" />
		</execute>

		<for list="ACTION_ADD_DISCUSSION,ACTION_ADD_LAYOUT,ACTION_CONFIGURE_PORTLETS,ACTION_CUSTOMIZE,ACTION_DELETE,ACTION_DELETE_DISCUSSION,ACTION_PERMISSIONS,ACTION_UPDATE,ACTION_UPDATE_DISCUSSION,ACTION_VIEW" param="permissionsInLineCheckListsCount" >
			<execute macro="Team#definePermissionPG">
				<var name="permissionDefinitionKey" value="${permissionsInLineCheckListsCount}" />
				<var name="teamName" value="Site Team Name" />
			</execute>
		</for>

		<execute macro="User#firstLoginPG">
			<var name="password" value="test" />
			<var name="userEmailAddress" value="userea1@liferay.com" />
		</execute>

		<execute macro="Page#gotoPG">
			<var name="pageName" value="Blog Page Template" />
		</execute>

		<execute macro="PageTemplate#viewDefaultPortletPG">
			<var name="pageTemplateName" value="Blog" />
		</execute>

		<execute macro="User#firstLoginPG">
			<var name="password" value="test" />
			<var name="userEmailAddress" value="userea2@liferay.com" />
		</execute>

		<execute macro="Page#openURL">
			<var name="pageName" value="Blog Page Template" />
		</execute>

		<execute function="AssertElementNotPresent" locator1="Home#PAGE_2" />

		<execute macro="User#firstLoginPG">
			<var name="password" value="test" />
			<var name="userEmailAddress" value="test@liferay.com" />
		</execute>
	</command>
</definition>